package utils;

import asymmetric.AsymmetricAgentFactory;
import core.AlgoAgentAbstract;
import core.SupportedAlgo;
import digest.DigestAgentFactory;
import symmetric.SymmetricAgentFactory;

import java.io.*;
import java.util.Base64;

/**
 * @author lzwgiter
 * @email float311@163.com
 * @since 2024/1/12
 */
public class Utils {
    /**
     * 将byte数组转换为16进制字符串
     *
     * @param bytes byte数组
     * @return 16进制字符串
     */
    public static String byteToHexString(byte[] bytes) {
        StringBuilder sb = new StringBuilder();
        for (byte aByte : bytes) {
            // 4位对应一个十六进制字符。分别取高位和低位添加
            sb.append(Character.forDigit((aByte & 240) >> 4, 16));
            sb.append(Character.forDigit(aByte & 15, 16));
        }
        return sb.toString();
    }

    /**
     * 将十六进制字符串转换为byte数组
     *
     * @param hexString 十六进制字符串
     * @return byte[]
     */
    public static byte[] hexStringToByte(String hexString) {
        byte[] result = new byte[hexString.length() / 2];
        for (int i = 0; i < hexString.length() / 2; i++) {
            // 分别还原高位和地位的字节数据
            byte high = Byte.parseByte(hexString.substring(i * 2, i * 2 + 1), 16);
            byte low = Byte.parseByte(hexString.substring(i * 2, i * 2 + 2), 16);
            result[i] = (byte) (high << 4 | low);
        }
        return result;
    }

    /**
     * 将byte数组转换为Base64字符串
     *
     * @param bytes 待编码数据
     * @return Base64字符串
     */
    public static String byteToBase64String(byte[] bytes) {
        return Base64.getEncoder().encodeToString(bytes);
    }

    /**
     * 将Base64字符串转换为byte数组
     *
     * @param base64String Base64字符串
     * @return byte[]
     */
    public static byte[] base64StringToByte(String base64String) {
        return Base64.getDecoder().decode(base64String);
    }

    /**
     * 格式化字符串为70字符一行
     *
     * @param keyBytes 原始字节字符串
     * @return 格式化的base64字符串
     */
    public static String normalizeFormat(byte[] keyBytes) {
        String base64KeyString = byteToBase64String(keyBytes);
        StringBuilder sb = new StringBuilder();
        int rowAccount = base64KeyString.length() / 70;
        for (int i = 0; i < rowAccount; i++) {
            sb.append(base64KeyString, i * 70, (i + 1) * 70).append("\n");
        }
        sb.append(base64KeyString, rowAccount * 70, base64KeyString.length() - 1);
        return sb.toString();
    }

    /**
     * 将算法结果写入文件
     *
     * @param data     算法输出
     * @param fileName 文件名称
     */
    public static void writeToFile(String data, String fileName) {
        try (FileWriter writer = new FileWriter(fileName)) {
            writer.write(data);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }

    /**
     * 获取算法代理工厂实例
     *
     * @param algoArg 算法名称参数
     * @return {@link AlgoAgentAbstract}
     */
    public static AlgoAgentAbstract getAgentFactory(String algoArg) {
        if (SupportedAlgo.SUPPORTED_DIGEST_ALGO.contains(algoArg)) {
            return DigestAgentFactory.getInstance().createAgent(algoArg);
        } else if (SupportedAlgo.SUPPORTED_ASYMMETRIC_ALGO.contains(algoArg)) {
            return AsymmetricAgentFactory.getInstance().createAgent(algoArg);
        } else if (SupportedAlgo.SUPPORTED_SYMMETRIC_ALGO.contains(algoArg)) {
            return SymmetricAgentFactory.getInstance().createAgent(algoArg);
        } else {
            return null;
        }
    }

    /**
     * 返回一个酒杯
     *
     * @return String
     */
    public static String getWineHere() {
        return "   #######               ####  \n" +
               " ###     ###           ###  ####\n" +
               "###       ###         ##        \n" +
               "###  ######################     \n" +
               " ### ##           ###    ##     \n" +
               "  #########################     \n" +
               "      ####################      \n" +
               "       ##              ##       \n" +
               "        ##            ##        \n" +
               "         ###        ###         \n" +
               "          ####     ###          \n" +
               "            ###  ###            \n" +
               "              ####              \n" +
               "               ##               \n" +
               "               ##               \n" +
               "               ##               \n" +
               "         ##############   \n" +
               "\n";
    }

    /**
     * 彩蛋
     *
     * @return String
     */
    public static String getBonus() {
        return "                                                                                                                                                                           \n" +
               " #@#*%##%#%*@#%%%%%%##%%%%@@#@@@%*@@@@@-@@@@@@@@@@%@@@@@@@@%*%*@=@-@=%=*#+%=#=%=+*@+%@%@@@#.:=@#***#*******************=   .=+%**+*#=  %@%+***  ##++**#*#*##*#**+++*+***## \n" +
               " *@%%%%#@#%%%%%%@@@@@@@#%##@  =@%#%@*@* *%*-*+++@%@@%*%%*%#%*#=%*@=%=%*#**%*%+%%@@% :@=       @@@@@@@#++***+**%%=%%#*++*%@*@@@%%#**%@@*  +%#:@@@@#+**************#***#%##+ \n" +
               " ###%%%#%*#%@%@@@:@@.@@@@@%@  @@%%%@.%: =#@=#*#+%+ +@@@@@@@*@@@@*%@@%@#@@@#@@@@*@@@@*@@@@%@@@@*%+=. =@%%####%:::==::-***+#.    . +#%  ..@ %@%@**+*****************#%%*+-:- \n" +
               " @%+###**++@@*@   +=   -.@@@* %*@@@*@@% :@%@#*==*=:@  :. : :: :    . . . .:.: :.   .  : .    :. . .:.#*****+*#%  :.@%#**+**%+@@@%#=*.==:. += +=#-:****#********#%#*+-:=+*# \n" +
               " @@@@%+#@@@@ .::-:.:.:::-@.:: :::.: -.*  % @.-+**+.@  @@@@@@@@@%%@*@=@%*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%********#%%+.: .:***+%##=-=#%% :.=@@%*%%*#*#%****#%%%%###**==+**###* \n" +
               "     -@#%%@@@@%@@@@%@@@@@@@@%.%@@@@+@@%+:@*@+*%**@ @%@%%#%#**-:=@@@@%-%@@@  **%@*-@@#-@@@@#**####@%********++****#%%#%###%*+--*%%%#*@@:%%*#***#*++#**%#%=*@@@#*+*+**=*%*** \n" +
               "+@@@@@%%@@%%@@@+%@@@@@@@@@@@@ @@@@* @@.. %:@%%@@*@ @*****#*+- @@@@%%%@@#%@@@%%*#*=%#@*#@  #*%%%*+%@###*****#%@@%%%%%*-**-#+#%%#%- @%..  *+*#*********#%@===*:#+***%+#***** \n" +
               " %%@@@@@ :@@=.:: :@@ =  @@  @  @    .+:..:= -*=**@ @@=-:   :.  @**@%@@@@@@%%%%%%%%@%%=    #      ..::%%@%@@%   :=..:::::.:..=* @. %#.  .#***###%#%#%#*+%+=*..**%#%@.@%%%@% \n" +
               ".@*-- .@@@@+:  = ::+ #%@* @@@  @@@@:*.:-*%% =#. =  %+    =:*+.:+. # .= - %*@@@@@= :.:@- ++%= ::% *=*#*#: :  :=-.:-----:-**%*%%.:  #=-: +=*#==***#@@@@=:*+=%.:%@@@%- *+=--+ \n" +
               " #%@@@@@%#@@@@ .@@@@@@@ *@@@@@@@ @@@@@@@@ @@@@@#@@@.@@@@@@@@@@@@@@@@ @@@@+ .#:. :%=#%.@@@@**@%%%.%%**%@  ::---%%:::+-::*-==*=*:#@=*@@@@@%%%+@@#-:-+  -+*+*%%% @  #@@@*%%%% \n" +
               "=@@@@@@@@@@%@@@@#=::--%@@#*=+=.@@@*=-... =+.  .:::::.     :::-:=+**@%   *   ==   # *% @@@@@@@%%@=%#*=     :=..==.-=+==**::.:-===-=+==..:+*+==+=##%@#:#%==*=: .@.:#=#%#@%%@ \n" +
               "   :%%##*****=+==--:.                                               +@@@@@@%*@@%%@@%%=    +%@@%%#%#*%@@@%#%@*+=*-%#***+#%##%##%*##**********++====-*@%%%@%#%%##%@#**%:*=#* \n" +
               " *=.                .:=**%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@      %%%%#=+***%@@@@@#-:=#%%@@@%#**#*++*%@@@*************#=***********%%%%%%@@%%#%%*%%%%@#*@%%%@*@%-. \n" +
               "  .=+%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@%@@@@@@@@%@@@%@@@@%%@@@%@%@@%%##@@      @@@@@@@@@@@@@%%%%+=::-==+#%*===*+-*: @+*********#*#%+*#****=+###***%%%%%%%%%##%*##%%%#%%#@%@@@@ \n" +
               "*@@@@@@@@@@@@@@@@@#@%%%%%%%%%%%#%%@%@%%%%%%%%@%%%%%%%%%%%%%%%%***#%%@@@@@@%=.          ..::::--==.    =:: .-+@* %-==::=======+**=#***+*%*#**#%%%%%%@%@@%#%%%*#%%: .::::::. \n" +
               "-@@@@%@@%%#@%@@%%@@@%@@@@@@@@@@@@@@%@@@@%@@@@%%@@%@%@@@%%@%%%%%@@%%*%%##%%+++======+++==-:    ::::-*#@%%%%%%=+*##=+++==--:::.::: .    #%##%%%#%%#*=+=#%#%%#%%%@%@##******* \n" +
               ":@@@%@@@@@@@@@@@@@@@@@@@%%@%#*###%%%@@@@@%%%%@%+%#****%%#%#*****+*#%#%%%#%*==++=+====:::-*%@@%+%@#   :##***####**%#****#%@@%@%%#-***+%@%%%%%##***#=#=#*#%%%%%#%@**###*#**+ \n" +
               "=@@@@@@@@**==-::::::::::==%#@@@@@@@@@@%#@%@@%@**%##%%%@@@@@@%#***###%%%@@@@@@%@%@@%*=-=*#@%%#@@%@@@@@@#*=********++*%%%%%#%%%%%@@@###%@%%%%%@@%%+===+%%%%@@@@@@@***####%%@ \n" +
               " -.       . =%@@@@@@@@@@@@%%=:... ..=*#%@%#*%%%#@@%@@%%@@@@@@@@@@@@@@%#%+    ...:=  @@@@@%%####%##*##%#%%****#****#######%#%##%*%%@%==@@@@%#*-:=*%###+===-- %%+=*#****#%## \n" +
               " =%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@*#*%%%#%%**-::              .:-*@+ .     @@@###%%##%%%##%%%#%###%%+=*++#%#%#%%%%%@@@@@@@@@@@-:=@=+=%@@%#%+=%%@%#*=.*%+****#%%%*## \n" +
               "=@@@@%@@%@%@%@@%@#%*%@@@@@@@@@@@@@@=: : -@@%%**+%%++*-%@@. .. -==++++++===*%%%@@%@@*%#%#%#%%%##%%%%%###%*##%*+=@%%%@@%%%%**%###*##@@@@=**+=*+#*+*%**%***%##*%**********#%@ \n" +
               "-@@@@@@@@@@@@@@@@@@@@%+:            *  =*=@%@@@@@@@@@@@@@@.%@*:..-=++++++++=====.@%#%#%%%#%#%%#####%####%%##@+=@%%%**+++*=+==++++=+==@+*%@%**+**@#:=*%#*******%%####****+= \n" +
               ":@@@@@%*:             .:==**##**+*@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#*==++**********:@%%@@@#%@@*%@%@@%%%%%%%#%%#@%:@%%*+***+*+++*****+++-@+*+%@@@@#==@@%+-+%%%#%+#****#*****=+ \n" +
               "        :-=**#%%#%%%%###*****==:  *@@@%@@@@@@@@@@@@@@@@@%@@%@@%*: #==++*+*+*++*+:@@@%===++*:*@#@@@@%@@@@%%%%@@=@%%****##*=++++=+*%@@=%%@@= @*=*@@@%@@@%+=+*##*##****%%#@%@ \n" +
               " %%%%%%%##****++====---::--:: :+@@@@@@@@@@@@@%@@*%%#%@@@@%%@%%@@@%**==*+****++++:@@%-+#%%@%- .::=----=**%@@@@%+@@@**@@%*%@@@***@@+=+#%@:==**@###*#@%***##@@%%%#*@@@******* \n" +
               " +===-=---:---===++**%%@@@#=%@@@@@%%@@%@%****=*+=+***%%@@%%%%%%%@@#@==+****#****=%@@=*#+-.:*@@*===+%@@%=+-*@@*#*@@*##%@@%@###+%%@@@@##@%**=%#%%#+=--=+*#***%@@%*+=***#**** \n" +
               " ==+*****%%@%%%%%##***+==++*=@@@%@@@@%=--=-==+******++**%%%##%@%%@@@#*=***#****%@=.@%-=%@@@#=+%=*@%=::=*%*%@*++= @%*#*+==+++@@%%-===++%%.@@@*#%%%@@@@%%*@@-.-.#@@@%%#****% \n" +
               " ##%%%##***=+++++++*******= @@@@@@@@#==**#%%**==++****++***###%%@%%@@%+*********+@=%+@%**=*%%*@+#%=@@#@@**@*%#=*+%%##***+***#==%*#****@%.-@@@%##%****%%*%*#:++: ==%%%@%@## \n" +
               " ***+*+*******************:=@@@@@@@*:**%@#*%@@@@#%+****+=---==+#@%@@@**+*+*++*++**:@==*====-=%*=%%+=++**=*%*%%#== @%*******#*+:******%%:=:%**#%%%%%%%*++%%@=+*=-%#*+=-+%@% \n" +
               " *************************:@@@@#=*  ::. :-:::::-=+++*++=+#@@@%*+%%@%******#*==::=-.@%#****#*@#*=#%+====-***%%%@@@**@##**+==@@@@@*++*#%-==-:%#**@@%%%*#**%%====-%#*+*%*%*== \n" +
               " ************************+:@@@@%@@@@@@@@@%%=#@@@%*++=+**#*+++#@@%@@%%**-     =@@@@@#%##**+**#*::=%**#****#%%%#%%#@.@%#%###+=::-=*%*##%%+:%::-%#==++=++**#+++==%%*#*#***+*# \n" +
               " ******************#******=@*.#@@::::=%@@@@@@@@@%%@@=-*%%=======%@%#=-=*@@@@@@@@@@%*@###**==#@@@@@=***%##@%%%%%%@@ +@%%%%@@@@@@@@%%@%**@@#:%=::#%#**#%%%==+:-@##*#*****#** \n" +
               " ***********#***********+*-**: @@=*#*+:%:*+====+==.@@@@=#@@@@=*%@@*%@@@@@@@%%#*#@@% @#+****+-:..:-=*##*+@@#%@@@@@*.:*@@@%++*%@%#**#-=**+*%@+%%%-.:==:::::#=*%%****##****## \n" +
               " #**********+*+=*****####*=*+@ @+=***+=@*=:-==+=*@=%=@@+=*#*%@@@ @*%@%@#*%@@@@@@%%#:%%%##%@@@@@@@@#**+=@@%%@#:-  %@. ..+@@#***#**==%*#*#*#@-@#%%%%%%@@@@%@-*#*##*********# \n" +
               " **************%*++=---:::*@@= @+#****==*@@@@@@@@%=#*+@*-=+**=#@ @##*++=@@  :*:=%.::-=%%*#**#%%***##**@@%@@*:@@@@@@@@@%-::*%@@**+@@%=%*+**%.%%#%%%*****+*#=%#********#**** \n" +
               " *######**+=**#%*-+@@@@@@@@#**-@*#*****+=====+**=++==-*@@@%%%+* @@@@@@@@@@@%%+=*@:::**=@%*==--=+*#%*-@@@@+*@@#   *@=-*%@@@*--*****@@:-**++%.*#**#*##**#*%#*********#*#*#*# \n" +
               " **======**+###@@@@%*-.      . %%##********#%#%###==--=+=:+****-@@@@%@%@@%@#%@#*%@@=:.--#@@%%###%# :@@*==*@@@%-::..@@*+*+%%@%*#*=+:@@@#%%%@-*%*#********#=#*#*****#**#*#*# \n" +
               " +#@@@@##@%*#*#*      -@@@@@@@@-%**#********+=****@@@@@@%=****-%@%@@%%%%%%@#*#%   :%@@:..=%*@%%+: +@@%.*@@%*@%*%%:=.%@@##*%%%*@@+*= @@=***%:=%*****#*#*#%=#*******=+++*#*% \n" +
               " %@*-     :****@@@@@@@@@@%@%@@@ @**#******+=--:::--::=**#=***=*@@%@%@@@@@@@@#@+@@@   =%@%.  ::  #@@@@*@@%@@#:=#%%%-:.:@@%#%%%=#@ =@**@-##%@-=%**#******%**##****#@%%#%=+*# \n" +
               "    :%@@@@=#**=@@@@%%%@@@@@@@@@ %%********%@@@@@@@@@@*=+*=**+=@@@%@%%%%%%%@#:= @@@@@@@::+%%@#*@@@@%@@##@@@@%%=:%%%%%:: %===:.-@@@ =: @%#**%==%#********#=*#*#*#*#*%@@@@*=*.\n" +
               "*@@@@@@@@ #**+*@@%#%###*%@@%*%@::@********%*@@%+..:-%@@@****:@@@%@%@%%@@%@@-.+.@@%%%@@@@@@@@@@@@%@@@@*@@@: :-==--%%%%-.@%:::@@@=@ -=.@%***%**#*#*#***%%@:%####*#*#*+*%@%%@ \n" +
               ".@@@@@@@-:*-*+@%#*#%#@@@@:  .-#%.@@%**#*##*++*%%%@%@@@=-+**:%@@@%%@@%@@@%@@%:*:#@%@@%%%%#%%@@%@%%@@@@@@: -*++**+=-%%%%- @@@@@%@-@=.=.@%***@=*%*#%%#%#%%%:%*##*******===+%% \n" +
               "+@@@ @ @ :#+=@@@@%@@@@@  :=*%@%@*.=@%####****++**##*+=+*#+:%@@@%%@%%%%%@%%@@.+:=@@@%%@%@%@@%%%%%%@%@=   =++*****===*%%%.@@*%@@@-@@ =.@%%**#=##****###**@:%***##%***#%%=#%@ \n" +
               "   ::*+@@@%#%@%@@@@*   -+=*@@%%=:=.-@%#********++******%*-@@@@@%%%@@@@%@@@@@:+ *@@%@%@%%@@#%%%@%@@@@*@%  +++**#+**+=-@%+:@@=@@@=@@.:-@****%+#***##*****%:%%##%####%#++#@@# \n" +
               " ==**@@ =:@@@@@@%  .:===%@@@%%%:=+=+.%@%#*+**+++++++*#@@*@@@%%%@@@%%%%@%%@-#=@:@@@@@@%@@%%@@@@@%%%@@@@@@  *******+++-=#%=:@@*@@-@@* +@%**%%+##*******%@#-@%%%##%%#***%@#*+ \n" +
               " ==@:@-#*-=.-:  .::=+*@@@%@*%%-:::@@@  %@@%++=+==++#@@@:. =@@@@@@@%%@@%%@@%@#@-@ :  @@%@@@@@%%%%%%%%@%@@@ :**++***+*+=:=%=:@@+@-@@% *%@%*******#****+=#*.%==+*#*****@%*+=+ \n" +
               " *@@@@@@@%++=*=+**@@@@@@@@*#*::=%@@- *=::=@@@@@@@@@@#::*- .@@%@%%%@%@@@@@@ #%*:@ =. @%@@@@@%@@%%@%%%@%%@@@ *****+*++***-:%=.@@*=@@@ %#*%%%+*#*####%%%#%*:@%%%****%*#*--=+% \n" +
               "                            ..       :                .  @@*=============#%      # =*=---:-:=-=:--:==:-:=@                   = : ..     .                             ...  ";
    }

}
